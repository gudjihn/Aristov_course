# Языки программирования и пользовательские типы данных

Создаем таблицу и наполняем данными
```sql
CREATE TABLE sales.sales
(
    id       integer generated by default as identity,
    sold_at  timestamp
);

INSERT INTO sales.sales (sold_at)
SELECT '2025-01-01'::timestamp + (random() * (365*24*60*60))::int * interval '1 second'
FROM generate_series(1, 50);
```
Создаем функцию [sales_by_third_of_year_get.sql](sales_by_third_of_year_get.sql)

Вызываем функцию
```sql
SELECT id, sold_at, month
FROM sales.sales_by_third_of_year_get(1);
```

Проверяем обработку входного параметра NULL
```sql
SELECT id, sold_at, month
FROM sales.sales_by_third_of_year_get(1);
```
Получаем исключение

Создаем функцию для вычисления месяца по формуле
[sales_by_third_of_year_get2.sql](sales_by_third_of_year_get2.sql)

Вызываем функцию
```sql
SELECT id, sold_at, month
FROM sales.sales_by_third_of_year_get2(1);
```